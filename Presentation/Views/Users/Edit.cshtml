@{
    ViewData["Title"]="Edit User";

    <style>
       
    </style>
}

<section id='users-edit'>
    <form class=''>
        <div class="d-flex align-items-center justify-content-between mb-3">
            <h1 class="fs-2">Add User</h1>
            <div class="d-flex align-items-center gap-3 justify-content-end">
                <a href='/Users/Index' class='btn btn-outline-secondary'>Cancel</a>
                <button type="button" @@click='createUserAsync' class='btn btn-primary'>Save</button>
            </div>
        </div>
         <div class='d-flex gap-4'>
            <fieldset class="flex-grow-1">
                <div class="mb-3">
                    <label for="exampleInputEmail1" class="form-label">First Name</label>
                    <input v-model='userForm.firstName' type="text" class="form-control w-100" id="exampleInputEmail1" aria-describedby="emailHelp">
                    <div id="emailHelp" class="form-text">We'll never share your email with anyone else.</div>
                </div>
                <div class="mb-3">
                    <label for="exampleInputEmail1" class="form-label">Last Name</label>
                    <input v-model='userForm.lastName' type="text" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp">
                    <div id="emailHelp" class="form-text">We'll never share your email with anyone else.</div>
                </div>
                <div class="mb-3">
                    <label for="exampleInputEmail1" class="form-label">Email address</label>
                    <input v-model='userForm.email' type="email" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp">
                    <div id="emailHelp" class="form-text">We'll never share your email with anyone else.</div>
                </div>
            </fieldset>
            <div class="mb-3 flex-grow-1">
                <label for="exampleInputEmail1" class="form-label">Image</label>
                <input @@change='updateImage' type="file" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp">
                <div id="emailHelp" class="form-text">We'll never share your email with anyone else.</div>
            </div>
        </div>
    </form>
</section>

@section Scripts {
    <script>
     var UsersEdit= Vue.createApp({
            data() {
                return {
                  userForm: {
                    firstName:'',
                    lastName:'',
                    email:'',
                    image:null
                  },
                  isImageUpdated: false
                };
            },
            methods: {
                createUserAsync(){
                    console.log("hi all")
                    axios.post('/Users/Create',this.userForm)
                    .then(resp=>{
                        console.log('added successfully');
                         @* window.location.href=`/Users/Index`; *@
                    });
                },
                updateImage(event){
                    const file = event.target.files[0];
                    if(!file) return;

                    const reader = new FileReader()

                     reader.onload = () => {
                        this.userForm.image = reader.result;
                        this.isImageUpdated = true;
                    };

                    reader.readAsDataURL(file)
                }
            },
            mounted() {
             
            }
        }).mount("#users-edit");
    </script>
}